---
name: ðŸ§³ Convert Markdown
on:
  workflow_call:
    inputs:
      FirstChangeDescription:
        description: "The first change description."
        required: false
        type: string
        default: Initial draft
      Folder:
        description: "The repository folder where the order file exist."
        required: false
        type: string
        default: docs
      GitLogLimit:
        description: "Maximum entries to get from Git Log for version history."
        required: false
        type: number
        default: 15
      HistoryFile:
        description: "The name of the history file."
        required: false
        type: string
        default: ""
      MainAuthor:
        description: "The main author of the PDF content."
        required: false
        type: string
        default: "Innofactor"
      OrderFile:
        description: "The name of the .order file."
        required: false
        type: string
        default: document.order
      OutFile:
        description: "The name of the output file."
        required: false
        type: string
        default: document.pdf
      Project:
        description: "The project ID or name."
        required: false
        type: string
        default: ""
      SkipGitCommitHistory:
        description: "Skip using git commit history."
        required: false
        type: boolean
        default: false
      Subtitle:
        description: "The document subtitle."
        required: false
        type: string
        default: ""
      Template:
        description: "The template name. Must be: designdoc."
        required: false
        type: string
        default: designdoc
      Title:
        description: "The document title."
        required: true
        type: string
      ReplaceFile:
        description: "The name of the replace file."
        required: false
        type: string
        default: ""
      RetentionDays:
        description: "Number of days to retain job artifacts."
        required: false
        type: number
        default: 5

jobs:
  build:
    name: Convert Markdown
    runs-on: ubuntu-22.04
    container:
      image: pandoc/extra:edge-alpine
      options: --entrypoint=sh
    steps:
      - name: Clone repository
        uses: actions/checkout@v4
        with:
          fetch-depth: ${{ inputs.GitLogLimit }}

      - name: Build PDF
        uses: innofactororg/markdown2pdf@v3beta1
        with:
          FirstChangeDescription: ${{ inputs.FirstChangeDescription }}
          Folder: ${{ inputs.Folder }}
          GitLogLimit: ${{ inputs.GitLogLimit }}
          HistoryFile: ${{ inputs.HistoryFile }}
          MainAuthor: ${{ inputs.MainAuthor }}
          OrderFile: ${{ inputs.OrderFile }}
          OutFile: ${{ inputs.OutFile }}
          Project: ${{ inputs.Project }}
          SkipGitCommitHistory: ${{ inputs.SkipGitCommitHistory }}
          Subtitle: ${{ inputs.Subtitle }}
          Template: ${{ inputs.Template }}
          Title: ${{ inputs.Title }}
          ReplaceFile: ${{ inputs.ReplaceFile }}
          RetentionDays: ${{ inputs.RetentionDays }}
